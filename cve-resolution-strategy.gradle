configurations.all {
  resolutionStrategy {
    eachDependency { DependencyResolveDetails details ->
      /* JAR upgrades with latest versions for CVE fixes*/
      /*
          CVE-2020-25649
      * */
      if (details.requested.name == 'jackson-databind') {
        details.useVersion '2.11.2'
      }

      /*
       * CVE-2022-29885
      */
      if (details.requested.name == 'tomcat-embed-core' || details.requested.name == 'tomcat-embed-websocket') {
        details.useVersion '9.0.63'
      }
      /*
          CVE-2020-25638
      * */
      if (details.requested.name == 'hibernate-core') {
        details.useVersion '5.4.25.Final'
      }

      /*
          CVE-2020-13956
      * */
      if (details.requested.name == 'httpclient') {
        details.useVersion '4.5.13'
      }

      /*
          CVE-2021-22112
      * */
      if (details.requested.name == 'spring-security-config'||details.requested.name == 'spring-security-core'||details.requested.name == 'spring-security-crypto'
        ||details.requested.name == 'spring-security-oauth2-client' ||details.requested.name == 'spring-security-oauth2-core' ||
        details.requested.name == 'spring-security-oauth2-jose' || details.requested.name == 'spring-security-oauth2-resource-server') {
        details.useVersion '5.4.5'
      }

      /* CVE-2022-22978 */
      if (details.requested.name == 'spring-security-web') {
        details.useVersion '5.5.7'
      }

      /*
          CVE-2021-22118
      * */
      if (details.requested.name == 'spring-aop'||details.requested.name == 'spring-aspects'||details.requested.name == 'spring-beans'
        ||details.requested.name == 'spring-context'||details.requested.name == 'spring-core'||details.requested.name == 'spring-expression'
        ||details.requested.name == 'spring-jcl'||details.requested.name == 'spring-jdbc'||details.requested.name == 'spring-orm'
        ||details.requested.name == 'spring-tx'||details.requested.name == 'spring-web'||details.requested.name == 'spring-webmvc'
      ) {
        details.useVersion '5.2.22.RELEASE'
      }

      /* CVE-2021-27568 */
      if (details.requested.name == 'json-smart') {
        details.useVersion '2.4.7'
      }

      /* CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090 */
      if (details.requested.name == 'commons-compress') {
        details.useVersion '1.21'
      }/* CVE-2021-22119 */
      if (details.requested.name == 'spring-security-core') {
        details.useVersion '5.6.1'
      }

      /* CVE-2021-22096 */
      if (details.requested.name == 'spring-core') {
        details.useVersion '5.2.22.RELEASE'
      }
      /* CVE fix with latest version ends here */

      /* CVE fixes 14feb 2022 start*/

      /*
       * CVE-2021-42550
      */
      if (details.requested.name == 'logback-core' || details.requested.name == 'logback-classic') {
        details.useVersion '1.2.10'
      }

      /* CVE-2021-22060 */
      if (details.requested.name == 'spring-core') {
        details.useVersion '5.2.22.RELEASE'
      }

      /*
       * CVE-2021-44832
      */
      if (details.requested.name == 'log4j-api' || details.requested.name == 'log4j-to-slf4j' || details.requested.name == 'log4j-core') {
        details.useVersion '2.17.1'
      }

    }
  }
}
